"use strict";(()=>{var e={};e.id=820,e.ids=[820],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3117:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p});var a={};r.r(a),r.d(a,{POST:()=>u});var n=r(9303),o=r(8716),s=r(670);let i=process.env.OPENAI_MODEL||"gpt-4o";function c(e,t){return(t?`event: ${t}
`:"")+`data: ${JSON.stringify(e)}

`}async function u(e){let t="Hello";try{let r=await e.json();"string"==typeof r?.message&&r.message.trim()&&(t=r.message.trim())}catch{}let r=process.env.OPENAI_API_KEY;if(!r)return new Response(c({detail:"Missing required environment variable: OPENAI_API_KEY"},"error")+"data: [DONE]\n\n",{headers:{"content-type":"text/event-stream; charset=utf-8","cache-control":"no-cache"},status:500});let a=new TextEncoder;return new Response(new ReadableStream({async start(e){try{let n=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${r}`},body:JSON.stringify({model:i,stream:!0,temperature:.2,max_tokens:600,messages:[{role:"system",content:"You are a helpful assistant for a Singapore Government analysis portal."},{role:"user",content:t}]})});if(!n.ok||!n.body){let t=await n.text().catch(()=>String(n.status));e.enqueue(a.encode(c({detail:t},"error"))),e.enqueue(a.encode("data: [DONE]\n\n")),e.close();return}let o=n.body.getReader(),s=new TextDecoder,u="";for(e.enqueue(a.encode(c({text:""})));;){let{value:t,done:r}=await o.read();if(r)break;let n=(u+=s.decode(t,{stream:!0})).split("\n\n");for(let t of(u=n.pop()??"",n))for(let r of t.split("\n")){let t=r.trim();if(!t.startsWith("data:"))continue;let n=t.slice(5).trim();if("[DONE]"===n){e.enqueue(a.encode("data: [DONE]\n\n")),e.close();return}try{let t=JSON.parse(n),r=t?.choices?.[0]?.delta?.content;r&&e.enqueue(a.encode(c({text:r})))}catch{}}}e.enqueue(a.encode("data: [DONE]\n\n")),e.close()}catch(t){e.enqueue(a.encode(c({detail:String(t)},"error"))),e.enqueue(a.encode("data: [DONE]\n\n")),e.close()}}}),{headers:{"content-type":"text/event-stream; charset=utf-8","cache-control":"no-cache"}})}let d=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/agent/stream/route",pathname:"/api/agent/stream",filename:"route",bundlePath:"app/api/agent/stream/route"},resolvedPagePath:"D:\\Working Directory 2025\\Peck Hwee\\Github Honey\\DealBreaker\\app\\api\\agent\\stream\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:m}=d,h="/api/agent/stream/route";function g(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[176],()=>r(3117));module.exports=a})();